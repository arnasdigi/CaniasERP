/*DOCUMENTTOTEXT 'RawData/Klientu_sarasas.xls' TO STRINGVAR3;

IF SYS_STATUS == 1 THEN
	STRINGVAR3 = SYS_STATUSERROR;
ENDIF;
*/
OBJECT: 
 STRING FILENAME,
 STRING PAVADINIMAS,
 STRING IMKODAS,
 STRING PVMKODAS,
 STRING ADRESAS,
 STRING KITAINFO,
 INTEGER KK,
 INTEGER KKM,
 TABLE TMPXMLTABLE;


FILENAME = 'RawData/Klientu_sarasas.xls';
KK=1;

CLEARTABLE TMPXMLTABLE; 
    
APPEND COLUMN PAVADINIMAS,STRING,100 TO TMPXMLTABLE;
APPEND COLUMN IMKODAS,STRING,100 TO TMPXMLTABLE;
APPEND COLUMN PVMKODAS,STRING,100 TO TMPXMLTABLE;
APPEND COLUMN ADRESAS,STRING,100 TO TMPXMLTABLE;
APPEND COLUMN KITAINFO,STRING,100 TO TMPXMLTABLE;

WHILE KK < 200
BEGIN
KKM=KK+1;
/*--Pavadinimas*/
ACCESSXLS FILENAME READ SHEET 1 B KK VALUE PAVADINIMAS;
/*--Im kodas*/
ACCESSXLS FILENAME READ SHEET 1 L KKM VALUE IMKODAS;
/*--PVM kodas*/
ACCESSXLS FILENAME READ SHEET 1 P KKM VALUE PVMKODAS;
/*--Adresas*/
ACCESSXLS FILENAME READ SHEET 1 W KKM VALUE ADRESAS;
/*--Kita Informacija*/
ACCESSXLS FILENAME READ SHEET 1 AD KKM VALUE KITAINFO;

IF PAVADINIMAS !='' THEN

BEGINTRAN;

APPEND ROW TO TMPXMLTABLE;
MOVE PAVADINIMAS TO TMPXMLTABLE_PAVADINIMAS;
MOVE IMKODAS TO TMPXMLTABLE_IMKODAS;
MOVE PVMKODAS TO TMPXMLTABLE_PVMKODAS;
MOVE ADRESAS TO TMPXMLTABLE_ADRESAS;
MOVE KITAINFO TO TMPXMLTABLE_KITAINFO;

COMMITTRAN;

ENDIF;

KK = KK+1;

ENDWHILE;

COPY TABLE TMPXMLTABLE INTO TMPTABLE;
SET TMPTABLE TO TABLE TMPTABLE;



